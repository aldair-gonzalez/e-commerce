const verCarrito=document.getElementById("verCarrito"),cerrarCarrito=document.getElementById("cerrarCarrito"),sectionCarrito=document.getElementById("sectionCarrito");verCarrito.addEventListener("click",(()=>{sectionCarrito.classList.add("active-carrito")})),cerrarCarrito.addEventListener("click",(()=>{sectionCarrito.classList.remove("active-carrito")}));const exitCategorias=document.getElementById("exitCategorias"),seccCategorias=document.getElementById("seccCategorias"),aProductos=document.getElementById("aProductos");aProductos.addEventListener("click",(t=>{t.preventDefault(),seccCategorias.classList.add("active-categorias")})),exitCategorias.addEventListener("click",(()=>{seccCategorias.classList.remove("active-categorias")}));const arrProductos=[];let carrito=[],arrPopulares=[];class Producto{constructor(t,r,e,o,a,n,i,c){this.producto=t,this.id=parseInt(r),this.precio=parseFloat(e),this.imagen=o,this.categoria=a.toLowerCase(),this.subCategoria=n.toLowerCase(),this.ventas=parseInt(i),this.info=c,this.cantidad=1}addCantidad(){return this.cantidad++}}const modalProductoCard=document.getElementById("modalProducto"),cerrarModal=document.getElementById("cerrarModal"),addCar=document.querySelector(".btn-addCarrito");function modalProducto(t){let r=[...document.getElementsByClassName(t)];for(const t of r){let r=document.getElementById("nombre-productoModal"),e=document.getElementById("precio-productoModal"),o=document.getElementById("img-modal"),a=document.getElementById("descripcionModal");t.addEventListener("click",(t=>{let n=arrProductos.find((r=>r.id==t.target.id));n&&(r.innerHTML=n.producto,e.innerHTML=n.precio,a.innerHTML=n.info,o.setAttribute("src",`${n.imagen}`),addCar.setAttribute("id",`${n.id}`),modalProductoCard.classList.add("active-modal"))})),cerrarModal.addEventListener("click",(()=>{modalProductoCard.classList.remove("active-modal")}))}}document.addEventListener("DOMContentLoaded",(()=>{peticion(),respuestaPop()}));const cards=document.getElementById("cards"),peticion=async()=>{try{const t=await fetch("script/json/api.json"),r=await t.json();for(const t of r)arrProductos.push(new Producto(t.producto,t.id,t.precio,t.imagen,t.categoria,t.subCategoria,t.ventas,t.info));pintarCards(arrProductos,cards)}catch(t){}};function pintarCards(t,r){for(const e of t){let t=document.createElement("div");t.classList.add("item"),t.classList.add("item-producto"),t.setAttribute("id",`${e.id}`),t.innerHTML=`\n            <div class="imagen">\n                <img loading="lazy" src="${e.imagen}" alt="${e.producto}" class="img">\n            </div>\n            <div class="info">\n                <h3 class="nombre">${e.producto}</h3>\n                <p class="precio">$<span id="precio">${e.precio}</span></p>\n            </div>\n        `,r.append(t),modalProducto("item-producto"),mouse("item-producto")}}const btnProductos=document.getElementsByClassName("btn-verMas");for(const t of btnProductos)t.addEventListener("click",(()=>{seccCategorias.classList.add("active-categorias")}));const filtroCategoria=document.getElementById("filtroCategoria");function filtrado(){filtroCategoria.innerHTML="",fetch("script/json/api.json").then((t=>t.json())).then((t=>{pintarFiltro(sinRepetir(t.map((t=>t.categoria))))}))}function pintarFiltro(t){for(const r of t)filtroCategoria.innerHTML+=`\n            <div class="bloque-filtro">\n                <h2 class="h2-filtro">${r}</h2>\n                <ul class="contenido-filtro">\n\n                </ul>\n            </div>\n        `,filtrar(),mouseHover("h2-filtro")}function mouseHover(t){[...document.getElementsByClassName(`${t}`)].forEach((t=>{cursorP(t)}))}filtrado();let filtradoCards=[];function filtrar(){let t=[...document.getElementsByClassName("bloque-filtro")],r=[...document.getElementsByClassName("h2-filtro")];r.forEach(((e,o)=>{r[o].addEventListener("click",(()=>{t.forEach(((r,e)=>{t[e].classList.remove("activo")})),t[o].classList.add("activo");let e=r[o].innerHTML,a=arrProductos.filter((t=>t.categoria==e)),n=sinRepetir(a.map((t=>t.subCategoria))),i=[...document.getElementsByClassName("contenido-filtro")];i.innerHTML="";for(const t of i){t.innerHTML="";for(const r of n)t.innerHTML+=`\n                    <li class="li-filtro">${r}</li>\n                    `}cards.innerHTML="",pintarCards(a,cards),pintarSubFiltro(n,a),mouseHover("li-filtro")}))}))}function pintarSubFiltro(t,r){let e=document.getElementsByClassName("li-filtro");for(const o of e)o.addEventListener("click",(()=>{for(const e of t)if(e==o.innerHTML){let t=r.filter((t=>t.subCategoria==e));cards.innerHTML="",pintarCards(t,cards)}}))}function sinRepetir(t){let r=[];return t.forEach((t=>{!r.includes(t)&&r.push(t)})),r}const cantidadCarrito=document.getElementById("cntdCar"),footerCarrito=document.getElementById("footer-carrito");function cntdCarritoBtn(){let t=Object.keys(carrito).length;cantidadCarrito.innerHTML=t,0==t&&(cantidadCarrito.innerHTML="")}function localStoraP(){localStorage.setItem("productosCarrito",JSON.stringify(carrito)),cntdCarritoBtn()}function carritoVacioNot(){if(Object.keys(carrito).length<1){let t=document.createElement("div");t.innerHTML='\n            <div class="vacio">\n                <p class="p">Comienza a comprar!!</p>\n            </div>\n        ',containerCardsCarrito.append(t)}}function pintarFooterCarrito(){carrito.length>0&&footerCarrito.classList.add("active");const t=document.getElementById("cantidad-footerCarrito"),r=document.getElementById("total-footerCarrito");let e=[...document.getElementsByClassName("input-cantidad")],o=[...document.getElementsByClassName("subTotal")];function a(t,r){let e=0;for(const o of r){let r=e+=parseInt(o.innerHTML);t.innerHTML=r}}a(t,e),a(r,o),carrito.length<=0&&footerCarrito.classList.remove("active")}const vaciarCarrito=document.getElementById("vaciarCarrito");vaciarCarrito.addEventListener("click",(()=>{carrito=[],localStorage.removeItem("productosCarrito"),pintarCarrito(carrito),carritoVacioNot(),pintarFooterCarrito(),cntdCarritoBtn()}));const containerCardsCarrito=document.getElementById("container-cards-carrito");function addCarrito(){addCar.addEventListener("click",(t=>{let r=carrito.find((r=>r.id==t.target.id));if(r)r.addCantidad();else{let r=arrProductos.find((r=>r.id==t.target.id));carrito.push(r)}pintarCarrito(carrito),pintarFooterCarrito(),localStoraP(),Toastify({text:"Se añadió al carrito",duration:3e3,gravity:"bottom",style:{background:"#474747"}}).showToast()}))}function pintarCarrito(t){containerCardsCarrito.innerHTML="";for(const r of t){let t=document.createElement("div");t.classList.add("producto-car"),t.setAttribute("id",`${r.id}cardProducto`),t.innerHTML=`\n            <div class="imagen">\n                <img loading="lazy" src="${r.imagen}" alt="${r.producto}" class="img">\n            </div>\n            <div class="info">\n                <h3 class="nombre">${r.producto}</h3>\n            </div>\n            <div class="cantidad">\n                <button class="button remove" id="${r.id}remove">-</button>\n                <p class="input-cantidad" id="${r.id}cantidad">${r.cantidad}</p>\n                <button class="button add" id="${r.id}add">+</button>\n            </div>\n            <div class="precio">\n                <p class="p total">$${r.precio}</span></p>\n                <p class="p subtotal">$<span class="subTotal" id="${r.id}subTotal">${r.precio}</span></p>\n            </div>\n            <button class="delete" title="Eliminar producto del carrito" id="${r.id}delete"><i class="fas fa-trash-alt"></i></button>\n        `,containerCardsCarrito.append(t),cantidad(r),pintarFooterCarrito()}}function cantidad(t){const r=document.getElementById(`${t.id}add`),e=document.getElementById(`${t.id}remove`),o=document.getElementById(`${t.id}cantidad`),a=document.getElementById(`${t.id}subTotal`),n=document.getElementById(`${t.id}cardProducto`),i=document.getElementById(`${t.id}delete`);function c(){if(t.cantidad=0,0==t.cantidad&&t.cantidad<1){let t=carrito.indexOf();carrito.splice(t,1)}}pintarFooterCarrito(),i.addEventListener("click",(()=>{n.remove(),c(),carritoVacioNot(),localStoraP(),pintarFooterCarrito(),carrito.length<=0&&footerCarrito.classList.remove("active")}));let d=t.cantidad*t.precio;a.innerHTML=d,r.addEventListener("click",(()=>{opCantidad=1+t.cantidad++,d=opCantidad*t.precio,o.innerHTML=opCantidad,a.innerHTML=d,localStoraP(),pintarFooterCarrito()})),e.addEventListener("click",(()=>{opCantidad=t.cantidad---1,d=opCantidad*t.precio,o.innerHTML=opCantidad,a.innerHTML=d,pintarFooterCarrito(),o.innerHTML<"1"&&(n.remove(),c(),pintarFooterCarrito()),carritoVacioNot(),localStoraP()}))}if(addCarrito(),"productosCarrito"in localStorage){pintarFooterCarrito();const t=JSON.parse(localStorage.getItem("productosCarrito"));for(const r of t)carrito.push(r);pintarCarrito(carrito)}pintarFooterCarrito(),carritoVacioNot(),cntdCarritoBtn();const containerCardsPopulares=document.getElementById("container-cards-populares"),containerCardsPopularesModal=document.getElementById("container-pop-modal"),respuestaPop=async()=>{try{const t=await fetch("script/json/api.json"),r=await t.json();for(const t of r)arrPopulares.push(t);populares(arrPopulares)}catch(t){}};function populares(t){let r=t.sort((function(t,r){return t.ventas>r.ventas?-1:t.ventas<r.ventas?1:0})).splice(0,4);pintarPop(r,containerCardsPopulares),pintarPop(r,containerCardsPopularesModal)}function pintarPop(t,r){r.innerHTML="";for(const e of t){let t=document.createElement("div");t.classList.add("card"),t.setAttribute("id",`${e.id}`),t.innerHTML=`\n            <div class="img-card">\n                <img loading="lazy" src="${e.imagen}" alt="${e.nombre}" class="img">\n            </div>\n            <div class="info-card">\n                <h3 class="h3">${e.producto}</h3>\n                <p class="p">$<span>${e.precio}</span></p>\n                <p class="ventas">Vendidos: <span>${e.ventas}</span></p>\n            </div>\n        `,r.append(t)}modalProducto("card"),mouse("card")}let innerCursor=document.getElementById("inner-cursor"),outerCursor=document.getElementById("outer-cursor");function moveCursor(t){let r=t.clientX,e=t.clientY;innerCursor.style.left=`${r}px`,innerCursor.style.top=`${e}px`,outerCursor.style.left=`${r}px`,outerCursor.style.top=`${e}px`}document.addEventListener("mousemove",moveCursor);const title=document.querySelector("h1"),links=Array.from(document.querySelectorAll("a")),button=Array.from(document.querySelectorAll("button"));function cursorP(t){t.addEventListener("mousemove",(()=>{innerCursor.classList.add("grow")})),t.addEventListener("mouseleave",(()=>{innerCursor.classList.remove("grow")}))}function mouse(t){[...document.getElementsByClassName(t)].forEach((t=>{cursorP(t)}))}cursorP(title),links.forEach((t=>{cursorP(t)})),button.forEach((t=>{cursorP(t)}));